# APK 版本管理目录

## 📁 目录说明

此目录用于存放应用的 APK 安装包。系统会**自动扫描**此目录中的 APK 文件，并返回**最新版本**给前端。

## 🚀 使用方法

### 1. 上传新版本APK
将新版本的 APK 文件放入此目录即可，文件名中必须包含版本号。

**支持的文件名格式：**
- `题库1.0.3.apk` ✅
- `app-1.0.3.apk` ✅
- `1.0.3.apk` ✅
- `题库v1.0.3.apk` ✅
- `myapp_1.2.0.apk` ✅

### 2. 版本号识别规则
系统会从文件名中自动提取版本号（格式：`x.x.x` 或 `x.x`）

**示例：**
- `题库1.0.3.apk` → 版本号：`1.0.3`
- `app-2.1.apk` → 版本号：`2.1`

### 3. 自动选择最新版本
- 系统会比较所有 APK 的版本号
- 自动选择版本号最高的 APK 提供给用户下载
- 例如目录中有：`1.0.1.apk`、`1.0.2.apk`、`1.0.3.apk`，系统会自动返回 `1.0.3.apk`

## ⚙️ 配置选项（可选）

可以在 `backend_service/.env` 文件中配置以下选项：

```env
# 服务器地址（可选，默认使用请求的域名）
SERVER_URL=http://你的服务器IP:3000

# 更新说明（可选，默认使用模板）
UPDATE_NOTES=1. 新增了xxx功能。\n2. 修复了xxx问题。\n3. 优化了xxx性能。

# 是否强制更新（可选，默认为 false）
FORCE_UPDATE=false
```

## 📝 注意事项

1. **文件名必须包含版本号**，否则该文件会被忽略
2. 版本号格式必须是 `数字.数字.数字` 或 `数字.数字`
3. 旧版本 APK 可以保留在目录中，系统会自动选择最新的
4. 建议定期清理旧版本 APK 以节省磁盘空间
5. 前端接口保持不变，无需修改前端代码

## 🔄 升级流程示例

**场景：**从 1.0.2 升级到 1.0.3

1. 将 `题库1.0.3.apk` 上传到此目录
2. （可选）更新 `.env` 中的 `UPDATE_NOTES`
3. 重启后端服务（如果修改了 .env）
4. 用户打开 APP 时会自动检测到新版本 1.0.3
5. 用户点击下载后会获取 `题库1.0.3.apk`

**就这么简单！** 🎉

## 📂 当前版本管理

系统返回的版本信息示例：
```json
{
  "version": "1.0.3",
  "downloadUrl": "http://你的服务器:3000/apk/题库1.0.3.apk",
  "notes": "版本 1.0.3 更新说明：\n1. 修复了若干已知bug。\n2. 优化了应用的性能和稳定性。",
  "forceUpdate": false
}
```
